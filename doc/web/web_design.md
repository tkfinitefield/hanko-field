# ウェブ

ウェブは Go + htmx で開発します。
Cloud Run で実行します。

---

## 方針

1. **完全パリティは不要**

* モバイルは「継続利用・いつでも再注文・撮影→即アップロード」。
* ウェブは「検索→流入→比較→納得→初回購入」「ギフト購買」を強化。

2. **差別化する領域**

* ランディング／カテゴリ一覧の**比較性**
* **SEO & シェア**（OGP最適化、ガイド記事）
* **ゲスト購入**・**ギフトフロー**・**請求書決済（B2B）**
* **大画面での編集 UX**（2ペイン編集・履歴タイムライン）

3. **共通で揃える領域（パリティ）**

* デザイン作成 → AI修正 → プレビュー → カート → 決済 → 注文追跡
* アカウント・住所帳・支払手段・再注文

---

## Webで“変える/足す”べき具体ポイント（アプリからの差分）

### 体験/UI

* **2ペインエディタ**：左フォーム（書体/余白/AI候補）、右プレビュー（htmxで差し替え）。
* **比較表**：素材・サイズ・価格・納期の**表比較**（モバイルはカード横スクロール）。
* **一括見積り**（B2B/ギフト）：「同デザイン × 複数素材・サイズ」のカート投入。
* **ゲスト購入導線**：ログイン無しで決済直前まで進める（メール認証のみ）。
* **ギフト機能**：宛先/メッセージ、納品書金額非表示、海外配送案内の強調。

### 集客/SEO

* **/guides/** 記事の**静的プリレンダ**＆スキーマ（JSON-LD）。
* **共有URL**：デザインの**プレビュー専用公開URL**（透かし入り画像）を簡単共有。
* **OGPテンプレ**：素材/テンプレ/サイズ選択でOGP自動生成（SNS映え）。

### 決済/法務

* **請求書発行リクエスト**（B2B）・**会社名/部署**を**住所フォーム**に追加。
* **国際配送の関税説明**を**チェックアウトに明示**（ウェブは長文OK）。

### 技術/パフォーマンス（Go＋htmx前提）

* **SSR＋部分差し替え**（`hx-get`/`hx-post`）で**初回TTFB重視**。
* 一覧は**初回SSR**→検索/ページングは**tbody差し替え**。
* プレビュー画像は**署名URL**を短寿命発行、差し替えは`hx-swap="outerHTML"`。
* **ドロワー/モーダルはフラグメント**で配信（`/modal/*`）。
* **楽観更新**：更新後は行の`<tr>`だけ差し替え、トーストで成功通知。

---

## 画面一覧と差別化ポイント

### 1) ランディング/探索

* `/` トップ（ヒーロー・CTA・比較表・ギフト訴求）
* `/shop` カテゴリ一覧（素材×形×サイズの**表フィルタ**）
* `/products/{productId}` SKU詳細（素材比較スライス/レビュー/納期）
* `/templates` / `/templates/{id}`（テンプレの**一覧表**＋デモ）
* `/guides` / `/guides/{slug}`（SEO対応・目次・関連記事）

> **差別化**：比較表・長文セクション・FAQアコーディオン・OGP最適化

### 2) デザイン作成〜AI

* `/design/new` 作成タイプ選択
* `/design/editor` **2ペイン**（左：フォーム/右：ライブプレビュー）
* `/design/ai` AI候補ギャラリー（グリッド、差分プレビュー）
* `/design/preview` 実寸・和紙モック・スタンプ風

> **差別化**：2ペイン＋ショートカット（S保存／Zやり直し）

### 3) カート/チェックアウト

* `/cart` 明細表（クーポン、ギフト設定列）
* `/checkout/address` 宛先/請求先（会社名・部署・領収書宛名）
* `/checkout/shipping` 料金比較表（国内/国際）
* `/checkout/payment` PSP
* `/checkout/review` 確認
* `/checkout/complete` 完了

> **差別化**：請求書要件、ギフト、表型UX

### 4) アカウント

* `/account` プロフィール
* `/account/addresses` 住所帳（会社項目あり）
* `/account/orders` / `/account/orders/{id}`（進捗・領収書DL）
* `/account/library` マイ印鑑（一覧表＋CSVエクスポート）
* `/account/security` ログイン連携・2FA

### 5) サポート/法務

* `/support` 問合せ
* `/legal/{slug}` 規約/特商法
* `/status` ステータス

---

## アプリ↔ウェブのマッピング（何を同じ/変える？）

| 機能       | モバイル(Flutter) | ウェブ(Go+htmx)         |
| -------- | ------------- | -------------------- |
| デザインエディタ | 1画面＋シート       | **2ペイン**（フォーム＋ライブ）   |
| 素材/サイズ選択 | カード横スクロール     | **表+フィルタ**（比較）       |
| AI提案     | 全画面ギャラリー      | **モーダルグリッド**＋差分プレビュー |
| 共有       | アプリ内共有        | **公開プレビューURL**＋OGP   |
| チェックアウト  | 簡易            | **ゲスト購入/請求書**／ギフト強化  |
| コンテンツ    | 簡略表示          | **SEO最適化**＋目次＋関連記事   |

---

## 実装チェックリスト（Web特有）

* [ ] **OGP**：商品/テンプレ/デザインプレビューに動的OGP
* [ ] **SEO**：`<h1/>`構造、canonical、構造化データ（Product/Article）
* [ ] **アクセシビリティ**：フォームラベル、キーボード操作（htmx + aria）
* [ ] **画像最適化**：`<img loading="lazy" srcset>`＋短寿命署名URL
* [ ] **CSRF**：`X-CSRF-Token` を htmx ヘッダに常時付与
* [ ] **Idempotency**：POST系はヘッダで冪等化
* [ ] **計測**：検索→商品→カート→購入の各イベントを計測（サーバ計測主体）

---

